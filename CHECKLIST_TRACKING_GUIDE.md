# HÆ¯á»šNG DáºªN Sá»¬ Dá»¤NG TÃNH NÄ‚NG THEO DÃ•I CHECKLIST

## Má»¤C ÄÃCH
Cho phÃ©p **Customer** theo dÃµi chi tiáº¿t quy trÃ¬nh kiá»ƒm tra xe cá»§a **Technician** trong thá»i gian thá»±c (real-time).

---

## TÃNH NÄ‚NG

### **1. Xem Timeline Quy TrÃ¬nh**
Customer cÃ³ thá»ƒ xem toÃ n bá»™ quy trÃ¬nh báº£o dÆ°á»¡ng gá»“m 7 bÆ°á»›c:
1. **Tiáº¿p nháº­n** - Xe Ä‘Ã£ Ä‘Æ°á»£c tiáº¿p nháº­n
2. **Kiá»ƒm tra** - Äang kiá»ƒm tra tÃ¬nh tráº¡ng xe â­ **(CÃ“ CHECKLIST)**
3. **BÃ¡o giÃ¡** - Chuáº©n bá»‹ bÃ¡o giÃ¡ phá»¥ tÃ¹ng (náº¿u cÃ³)
4. **Chá» phá»¥ tÃ¹ng** - Chá» phá»¥ tÃ¹ng vá» kho (náº¿u chÆ°a cÃ³ sáºµn)
5. **Äang thá»±c hiá»‡n** - Thay phá»¥ tÃ¹ng vÃ  báº£o dÆ°á»¡ng
6. **HoÃ n thÃ nh** - Sáºµn sÃ ng thanh toÃ¡n
7. **ÄÃ£ giao xe** - ÄÃ£ thanh toÃ¡n vÃ  nháº­n xe

### **2. Xem Checklist Chi Tiáº¿t (BÆ°á»›c 2: Kiá»ƒm tra)**
Khi ServiceOrder á»Ÿ tráº¡ng thÃ¡i **INSPECTION**, Customer cÃ³ thá»ƒ:
- **Click vÃ o bÆ°á»›c "Kiá»ƒm tra"** trong Timeline
- Timeline sáº½ **má»Ÿ rá»™ng** vÃ  hiá»ƒn thá»‹ danh sÃ¡ch Checklist
- Xem **tá»«ng má»¥c kiá»ƒm tra** vá»›i:
  - âœ… **OK** - Má»¥c kiá»ƒm tra Ä‘áº¡t
  - âŒ **NOT_OK** - Má»¥c cÃ³ váº¥n Ä‘á»/lá»—i
  - â³ **NOT_CHECKED** - ChÆ°a kiá»ƒm tra
- Xem **ghi chÃº** chi tiáº¿t cá»§a Technician
- Xem **hÃ¬nh áº£nh báº±ng chá»©ng** (náº¿u cÃ³)

### **3. Real-time Updates**
- Checklist **tá»± Ä‘á»™ng cáº­p nháº­t** má»—i 10 giÃ¢y
- KhÃ´ng cáº§n refresh trang thá»§ cÃ´ng
- Tháº¥y Ä‘Æ°á»£c Technician Ä‘ang kiá»ƒm tra má»¥c nÃ o

---

## HÆ¯á»šNG DáºªN Sá»¬ Dá»¤NG

### **BÆ°á»›c 1: VÃ o trang History**
1. ÄÄƒng nháº­p vá»›i tÃ i khoáº£n Customer
2. VÃ o menu **"Lá»‹ch sá»­"** hoáº·c **"History"**
3. Xem danh sÃ¡ch cÃ¡c Appointment Ä‘Ã£ Ä‘áº·t

### **BÆ°á»›c 2: Click "Theo dÃµi"**
1. TÃ¬m Appointment cÃ³ tráº¡ng thÃ¡i **"Äang kiá»ƒm tra"** hoáº·c cÃ¡c tráº¡ng thÃ¡i khÃ¡c cá»§a ServiceOrder
2. Click nÃºt **"Theo dÃµi"** (mÃ u xanh vá»›i icon ðŸš—)
3. Há»‡ thá»‘ng sáº½ chuyá»ƒn Ä‘áº¿n trang **OrderTracking**

### **BÆ°á»›c 3: Xem Timeline**
1. Máº·c Ä‘á»‹nh hiá»ƒn thá»‹ tab **"Quy trÃ¬nh thá»±c hiá»‡n"**
2. Xem cÃ¡c bÆ°á»›c quy trÃ¬nh vá»›i:
   - **BÆ°á»›c Ä‘Ã£ hoÃ n thÃ nh**: Icon âœ… mÃ u xanh
   - **BÆ°á»›c Ä‘ang thá»±c hiá»‡n**: Icon vÃ  text mÃ u xanh, cÃ³ badge "Äang thá»±c hiá»‡n"
   - **BÆ°á»›c chÆ°a Ä‘áº¿n**: Icon vÃ  text mÃ u xÃ¡m

### **BÆ°á»›c 4: Xem Checklist (Chá»‰ á»Ÿ bÆ°á»›c Kiá»ƒm tra)**
1. **Click vÃ o bÆ°á»›c "Kiá»ƒm tra"** trong Timeline
2. Timeline sáº½ **má»Ÿ rá»™ng xuá»‘ng** vá»›i animation mÆ°á»£t
3. Hiá»ƒn thá»‹:
   - **TÃªn checklist**: VD "Checklist Báº£o dÆ°á»¡ng Ä‘á»‹nh ká»³"
   - **Thá»‘ng kÃª**: Sá»‘ lÆ°á»£ng OK, Lá»—i, Chá»
   - **Danh sÃ¡ch items**: Tá»«ng má»¥c kiá»ƒm tra vá»›i:
     - Icon tráº¡ng thÃ¡i (âœ…/âŒ/â³)
     - TÃªn má»¥c kiá»ƒm tra
     - Ghi chÃº cá»§a Technician (náº¿u cÃ³)
     - Link xem hÃ¬nh áº£nh (náº¿u cÃ³)

### **BÆ°á»›c 5: Xem hÃ¬nh áº£nh báº±ng chá»©ng**
1. Náº¿u Technician upload hÃ¬nh áº£nh â†’ CÃ³ link **"Xem hÃ¬nh áº£nh"** hoáº·c **"HÃ¬nh áº£nh"**
2. Click vÃ o link â†’ Má»Ÿ hÃ¬nh áº£nh trong tab má»›i
3. Xem chi tiáº¿t váº¥n Ä‘á» Technician phÃ¡t hiá»‡n

### **BÆ°á»›c 6: Thu gá»n Checklist**
1. Click láº¡i vÃ o bÆ°á»›c **"Kiá»ƒm tra"**
2. Checklist sáº½ thu gá»n láº¡i

### **BÆ°á»›c 7: Xem tab "Kiá»ƒm tra chi tiáº¿t" (TÃ¹y chá»n)**
1. Click tab **"Kiá»ƒm tra chi tiáº¿t"** á»Ÿ Ä‘áº§u trang
2. Xem toÃ n bá»™ Checklist vá»›i giao diá»‡n Accordion
3. Click vÃ o tá»«ng checklist Ä‘á»ƒ má»Ÿ rá»™ng
4. Xem danh sÃ¡ch items dáº¡ng lÆ°á»›i (grid layout)

---

## GHI CHÃš QUAN TRá»ŒNG

### **âš ï¸ Khi nÃ o cÃ³ thá»ƒ xem Checklist?**
- **Chá»‰ khi ServiceOrder á»Ÿ tráº¡ng thÃ¡i `INSPECTION`**
- Náº¿u chÆ°a cÃ³ Technician táº¡o Checklist â†’ Hiá»ƒn thá»‹ "ChÆ°a cÃ³ dá»¯ liá»‡u kiá»ƒm tra"
- Khi chuyá»ƒn sang bÆ°á»›c khÃ¡c (QUOTING, IN_PROGRESS,...) â†’ Checklist khÃ´ng cÃ²n hiá»ƒn thá»‹ trong Timeline (nhÆ°ng váº«n lÆ°u trong lá»‹ch sá»­)

### **âœ… Lá»£i Ã­ch cá»§a tÃ­nh nÄƒng:**
1. **Minh báº¡ch**: Customer biáº¿t chÃ­nh xÃ¡c Technician Ä‘ang lÃ m gÃ¬
2. **YÃªn tÃ¢m**: Tháº¥y Ä‘Æ°á»£c tá»«ng má»¥c kiá»ƒm tra, hÃ¬nh áº£nh báº±ng chá»©ng
3. **Tiáº¿t kiá»‡m thá»i gian**: KhÃ´ng cáº§n gá»i Ä‘iá»‡n há»i tiáº¿n Ä‘á»™
4. **ChuyÃªn nghiá»‡p**: NÃ¢ng cao tráº£i nghiá»‡m dá»‹ch vá»¥

### **ðŸ“± Responsive:**
- Giao diá»‡n tá»‘i Æ°u cho cáº£ Desktop vÃ  Mobile
- TrÃªn Mobile: Checklist items tá»± Ä‘á»™ng Ä‘iá»u chá»‰nh layout

### **ðŸ”„ Auto-refresh:**
- Checklist tá»± Ä‘á»™ng cáº­p nháº­t má»—i 10 giÃ¢y
- Console log sáº½ hiá»ƒn thá»‹: `Fetching checklists for orderId: ...`

---

## VÃ Dá»¤ CHECKLIST

```
ðŸ“‹ Checklist Báº£o dÆ°á»¡ng Ä‘á»‹nh ká»³ 10,000 km
   âœ… 5 OK   âŒ 2 Lá»—i   â³ 3 Chá»

   âœ… Kiá»ƒm tra má»©c dáº§u phanh
      Ghi chÃº: Dáº§u phanh cÃ²n Ä‘á»§, cháº¥t lÆ°á»£ng tá»‘t

   âŒ Kiá»ƒm tra lá»‘p xe
      Ghi chÃº: Lá»‘p trÆ°á»›c trÃ¡i mÃ²n 70%, cáº§n thay
      ðŸ–¼ï¸ Xem hÃ¬nh áº£nh

   âœ… Kiá»ƒm tra Ä‘Ã¨n chiáº¿u sÃ¡ng
      Ghi chÃº: ÄÃ¨n hoáº¡t Ä‘á»™ng bÃ¬nh thÆ°á»ng

   âŒ Kiá»ƒm tra mÃ¡ phanh
      Ghi chÃº: MÃ¡ phanh sau cÃ²n 20%, khuyáº¿n nghá»‹ thay
      ðŸ–¼ï¸ Xem hÃ¬nh áº£nh

   â³ Kiá»ƒm tra há»‡ thá»‘ng lÃ m mÃ¡t
   â³ Kiá»ƒm tra bá»™ lá»c khÃ´ng khÃ­
   â³ Kiá»ƒm tra há»‡ thá»‘ng treo
```

---

## TROUBLESHOOTING (Xá»¬ LÃ Sá»° Cá»)

### **â“ KhÃ´ng tháº¥y nÃºt "Theo dÃµi"?**
- Kiá»ƒm tra Appointment pháº£i cÃ³ `serviceOrderId`
- Chá»‰ hiá»ƒn thá»‹ khi Appointment á»Ÿ tráº¡ng thÃ¡i `IN_SERVICE` trá»Ÿ Ä‘i

### **â“ Click vÃ o "Kiá»ƒm tra" nhÆ°ng khÃ´ng má»Ÿ ra?**
- Kiá»ƒm tra Console log: `Cannot expand - checklists.length: 0`
- CÃ³ nghÄ©a lÃ  chÆ°a cÃ³ Checklist â†’ Äá»£i Technician táº¡o

### **â“ KhÃ´ng tháº¥y hÃ¬nh áº£nh?**
- Kiá»ƒm tra Technician cÃ³ upload hÃ¬nh áº£nh khÃ´ng (evidenceUrl)
- Náº¿u cÃ³ link nhÆ°ng khÃ´ng hiá»ƒn thá»‹ â†’ Kiá»ƒm tra S3 bucket permissions

### **â“ Checklist khÃ´ng tá»± Ä‘á»™ng cáº­p nháº­t?**
- Kiá»ƒm tra Console log: `Fetching checklists...` má»—i 10 giÃ¢y
- Náº¿u khÃ´ng cÃ³ log â†’ Kiá»ƒm tra useEffect trong OrderTracking.jsx
- Clear cache vÃ  hard refresh (Ctrl + Shift + R)

---

## TECHNICAL INFO (DÃ€NH CHO DEVELOPER)

### **Files liÃªn quan:**
- `OrderTracking.jsx` - Trang chÃ­nh, fetch checklists
- `OrderTimeline.jsx` - Component Timeline, expandable checklist
- `OrderTimeline.css` - Styling cho expansion
- `checklistService.js` - API service fetch checklist

### **API Endpoint:**
```
GET /api/checklist/service-order/{serviceOrderId}
```

### **Response format:**
```json
[
  {
    "checklistId": 1,
    "templateName": "Checklist Báº£o dÆ°á»¡ng Ä‘á»‹nh ká»³",
    "items": [
      {
        "itemName": "Kiá»ƒm tra má»©c dáº§u phanh",
        "status": "OK",
        "notes": "Dáº§u phanh cÃ²n Ä‘á»§",
        "evidenceUrl": "https://s3.amazonaws.com/..."
      },
      {
        "itemName": "Kiá»ƒm tra lá»‘p xe",
        "status": "NOT_OK",
        "notes": "Lá»‘p mÃ²n 70%",
        "evidenceUrl": "https://s3.amazonaws.com/..."
      }
    ]
  }
]
```

### **Auto-refresh logic:**
```javascript
useEffect(() => {
  fetchChecklists();
  const interval = setInterval(() => {
    fetchChecklists();
  }, 10000); // 10 seconds
  return () => clearInterval(interval);
}, [orderId]);
```

---

**TÃ i liá»‡u Ä‘Æ°á»£c táº¡o bá»Ÿi: APEX EV Development Team**  
**NgÃ y cáº­p nháº­t: 06/12/2025**  
**Version: 1.0**
